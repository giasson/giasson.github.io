!function(e){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?e(require("knockout"),exports):"function"==typeof define&&define.amd?define(["knockout","exports"],e):e(ko)}(function(e,t){function n(){return"_scope"+ ++n.counter}function i(t,n,r,o){o=o||[];for(var a in t){var s=t[a];if(e.isWriteableObservable(s)&&s.editable!==!1&&(s.extend({editable:{enable:!0,scope:n}}),r.push(s)),!(e.utils.arrayIndexOf(o,s)>-1)){o.push(s);var l=e.utils.unwrapObservable(s);if("object"==typeof l){var c=e.isObservable(s);if(c){if(e.utils.arrayIndexOf(o,l)>-1)continue;o.push(l)}i(l,n,r,o)}}}}var r=function(t){return e.dependentObservable({read:t,deferEvaluation:!0})},o="",a={_observables:{},add:function(t,n){this._observables.hasOwnProperty(t)||(this._observables[t]=e.observableArray()),this._observables[t].push(n)},get:function(n){if(n=n===t?o:n,!this._observables.hasOwnProperty(n))throw new Error("Unknown scope "+n);return e.utils.unwrapObservable(this._observables[n])}};a._observables[o]=e.observableArray(),n.counter=0;var s={scalar:function(e,t){return e==t},array:function(e,t){if(e=e||[],t=t||[],e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}},l={enable:!0,scope:o};e.extenders.editable=function(n,i){if(n.hasOwnProperty("editable"))return n;if(i="object"!=typeof i?{enable:i===t?!0:i,scope:o}:e.utils.extend(e.utils.extend({},l),i),n.editable=i.enable,!n.editable)return n;var c,d=s.scalar,h=n.inTransaction=e.observable(!1);return n.beginEdit=function(){if(!h()){var e=n();e instanceof Array&&(e=e.slice(),d=s.array),c=e,h(!0)}},n.commit=function(){h(!1)},n.rollback=function(){h()&&(n(c),h(!1))},n.oldValue=function(){return c},n.hasChanges=r(function(){var e=h()&&!d(n(),c);return e}),i.scope!==!1&&a.add(i.scope,n),n},e.editable=function(o,a){if("function"!=typeof o.beginEdit){a=a===t?!0:a;var s=e.observableArray();o.beginEdit=function(){e.utils.arrayForEach(s(),function(e){e.beginEdit()})},o.commit=function(){e.utils.arrayForEach(s(),function(e){e.commit()})},o.rollback=function(){e.utils.arrayForEach(s(),function(e){e.rollback()})},o.hasChanges=r(function(){var t=e.utils.arrayFirst(s(),function(e){return e.hasChanges()});return null!=t});var l=n();o.addEditable=function(e){i(e,l,s,[])},a&&i(o,l,s,[])}},e.editable.enable=function(e,n){n===t&&(n=o),i(e,n,[])},e.editable.beginEdit=function(t){e.utils.arrayForEach(a.get(t),function(e){e.beginEdit()})},e.editable.commit=function(t){e.utils.arrayForEach(a.get(t),function(e){e.commit()})},e.editable.rollback=function(t){e.utils.arrayForEach(a.get(t),function(e){e.rollback()})},e.editable.hasChanges=function(e){for(var t=a.get(e),n=0,i=t.length;i>n;n++)if(t[n].hasChanges())return!0;return!1},e.editable._editables=a,e.editable.getHasChangesFlag=function(t){return r(function(){return e.editable.hasChanges(t)}).extend({throttle:100})}});